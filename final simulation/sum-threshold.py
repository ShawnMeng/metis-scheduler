#!/usr/bin/python2

import itertools

print "Start process of computing sum(X) given a placement, input is the total cost for assignments"

rnum = int(raw_input("Number of reducers:"))
snum = int(raw_input("Number of servers:"))
optimal = 0
opt_ass = list()
total = 0
# Assuming rnum = snum.

matrix = [[0 for x in range(snum)] for y in range(rnum)]

matrix = [[16171305, 16171305, 32342610, 32342610, 32342610, 32342610, 32342610, 32342610, 32342610, 32342610, 32342610, 32342610, 32342610, 32342610, 32342610, 32342610], 
[10483470, 10483469, 20966939, 20966939, 20966939, 20966939, 20966939, 20966939, 20966939, 20966939, 20966939, 20966939, 20966939, 20966939, 20966939, 20966939], 
[30047675, 15023838, 15023838, 30047675, 30047675, 30047675, 30047675, 30047675, 30047675, 30047675, 30047674, 30047675, 30047675, 30047675, 30047675, 30047675], 
[30045646, 30045646, 15022823, 15022823, 30045646, 30045646, 30045646, 30045646, 30045646, 30045646, 30045646, 30045646, 30045646, 30045646, 30045646, 30045646], 
[30044989, 30044989, 30044989, 15044989, 15000001, 30044989, 30044989, 30044988, 30044989, 30044989, 30044989, 30044989, 30044989, 30044989, 30044989, 30044989], 
[30038679, 30038680, 30038680, 30038680, 30038680, 15000001, 15038680, 30038680, 30038680, 30038680, 30038680, 30038680, 30038680, 30038680, 30038680, 30038680], 
[30036597, 30036597, 30036597, 30036597, 30036597, 30036597, 15000001, 15036597, 30036597, 30036597, 30036597, 30036597, 30036597, 30036597, 30036597, 30036596], 
[30041449, 30041450, 30041450, 30041450, 30041450, 30041450, 30041450, 15000001, 15041450, 30041450, 30041450, 30041450, 30041450, 30041450, 30041450, 30041450], 
[30039143, 30039144, 30039144, 30039144, 30039144, 30039144, 30039144, 15000001, 15039144, 30039144, 30039144, 30039144, 30039144, 30039144, 30039144, 30039144], 
[30039178, 30039178, 30039178, 30039178, 30039178, 30039178, 30039178, 30039178, 15019590, 15019589, 30039178, 30039178, 30039178, 30039178, 30039178, 30039177], 
[30035978, 30035978, 30035978, 30035978, 30035977, 30035978, 30035978, 30035978, 30035978, 15000001, 15035978, 30035978, 30035978, 30035978, 30035978, 30035978], 
[30033750, 30033750, 30033750, 30033750, 30033750, 30033749, 30033750, 30033750, 30033750, 30033750, 16004833, 14028918, 30033750, 30033750, 30033750, 30033750], 
[30032707, 30032707, 30032707, 30032707, 30032707, 30032707, 30032707, 30032707, 30032707, 30032706, 30032707, 15016354, 15016354, 30032707, 30032707, 30032707], 
[30031344, 30031345, 30031345, 30031345, 30031345, 30031345, 30031345, 30031345, 30031345, 30031345, 30031345, 30031345, 15000001, 15031345, 30031345, 30031345], 
[30031385, 30031386, 30031386, 30031386, 30031386, 30031386, 30031386, 30031386, 30031386, 30031386, 30031386, 30031386, 30028578, 15025140, 15009055, 30031386], 
[29630326, 29630326, 29630326, 29630326, 29630326, 29630326, 29630326, 29630326, 29630326, 29630326, 29630326, 29630326, 29630326, 29630326, 14127532, 15502794]]
#        print "Please enter the edge weight for reducer", x, "on server", y, ": "
#        ew = int(raw_input())
#        matrix[x][y] = ew


for x in range(rnum):
    print "\n"
    for y in range(snum):
        print(matrix[x][y]),
print "\n"

#perms = list(itertools.permutations(range(snum)))
#print "Total number of permutations: ", len(perms)
#for perm in perms:
#for server 0  1  2  3  4   5  6  7  8   9  10  11  12  13  14  15
#
perm = [1, 0, 2, 3, 4, 5, 6, 8, 7, 9, 10, 11, 12, 13, 14, 15]
assignment = list(perm)
for i in range(rnum):
    ass_ri = assignment[i]
#    sum_ri = sum((matrix[i])) - matrix[i][ass_ri]
    print "Reducer ", i, "onto ", ass_ri, " with cost: ", matrix[i][ass_ri]
    total += matrix[i][ass_ri]
# print perm, total
# if total <= optimal or optimal == 0:
#    optimal = total
#    opt_ass = assignment
#    print "Current TOTAL!!!: ", optimal, "with ", opt_ass
#    total = 0

print "SUM for assignment: ", total, "with ", perm















