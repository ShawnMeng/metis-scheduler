#!/usr/bin/python2

import itertools

print "Start process of computing max(X) given a placement, input is the total cost for assignments"

rnum = int(raw_input("Number of reducers:"))
snum = int(raw_input("Number of servers:"))
optimal = 0
opt_ass = list()
total = 0
# Assuming rnum = snum.

matrix = [[0 for x in range(snum)] for y in range(rnum)]

matrix = [[2918509,4280114,4743178,4317601,4742947,4623322,4713528,4743962,4701545,4743962,4703841,4695160,4743962,4460375,4692564,3334860],
          [4566742,4566742,4566742,4566742,4566742,4562141,4292546,4566238,4171021,4566334,4164982,4179136,4566448,1939812,4092021,4566741],
          [4566664,4566665,4566665,4566665,4566665,4566665,4566665,4566665,4566665,4566665,4566665,4566665,4566665,4566665,4561018,5648],
          [4566348,4566348,4566348,4566348,4566348,4566348,4566348,4566348,4566348,4566348,4566348,4566348,4566348,4566348,4566348,0.001],
          [4233952,4544067,4544067,4544067,4544067,4544067,4544067,4544067,4544067,4544067,4544067,4544067,4544067,4544067,4544067,310115],
          [1,4257854,4257854,4257854,4257854,4257854,4257854,4257854,4257854,4257854,4257854,4257854,4257854,4257853,4257854,4257854],
          [1,4258023,4258023,4258023,4258023,4258023,4258023,4258023,4258023,4258023,4258023,4258023,4258023,4258023,4258023,4258022],
          [1,4258041,4258041,4258041,4258041,4258041,4258041,4258041,4258041,4258041,4258041,4258041,4258041,4258040,4258041,4258041],
          [0.001,4258436,4258436,4258436,4258436,4258436,4258436,4258436,4258436,4258436,4258436,4258436,4258436,4258436,4258436,4258436],
          [4253360,4470,4257750,4257790,4257790,4257790,4257790,4257790,4257790,4257790,4257790,4257790,4257790,4257790,4257790,4257790],
          [4258442,4258397,4252194,6294,4258442,4258442,4258442,4258442,4258442,4258442,4258442,4258442,4258442,4258442,4258442,4258441],
          [4257984,4257985,4257985,4255883,4251732,3049368,1216973,4257985,4257985,4257985,4257985,4257985,4257985,4257985,4257985,4257985],
          [4258739,4258739,4258739,4258739,4258739,4258739,4257888,4252490,7100,4258739,4258739,4258739,4258739,4258739,4258739,4258739],
          [4258296,4258296,4258296,4258296,4258296,4258296,4258296,4258296,4255566,4252046,8980,4258296,4258296,4258296,4258296,4258296],
          [4258476,4258477,4258477,4258477,4258477,4258477,4258477,4258477,4258477,4258477,4253724,4754,4258477,4258477,4258477,4258477],
          [4109574,4109575,4109575,4109575,4109575,4109575,4109575,4109575,4109575,4109575,4109575,4108929,4103331,6891,4109575,4109575]]

#for x in range(rnum):
#    for y in range(snum):
#        print "Please enter the edge weight for reducer", x, "on server", y, ": "
#        ew = int(raw_input())
#        matrix[x][y] = ew


for x in range(rnum):
    print "\n"
    for y in range(snum):
        print(matrix[x][y]),
print "\n"

#perms = list(itertools.permutations(range(snum)))
#print "Total number of permutations: ", len(perms)
#for perm in perms:
#for server 0  1  2  3  4  5  6  7  8   9  10  11  12  13  14  15
#          16  5 13  4  8  9 15  7  14  6  12  10  3   1   11   2
perm = [5 , 14 , 12 , 15 , 2 , 4 , 7 , 9 , 0 , 1 , 3 , 6 , 8 , 10 , 11 , 13]
assignment = list(perm)
max = 0

for i in range(rnum):
    ass_ri = assignment[i]
    #    sum_ri = sum((matrix[i])) - matrix[i][ass_ri]
    print "Reducer ", i, "onto ", ass_ri, " with cost: ", matrix[i][ass_ri]
    if matrix[i][ass_ri] > max:
        max = matrix[i][ass_ri]
    print "Current MAX!!!: ", max
#    total = 0

print "max with assignment: ", max, "with ", perm














