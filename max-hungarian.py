#!/usr/bin/python2

import itertools

print "Start process of computing max(X) given a placement, input is the total cost for assignments"

rnum = int(raw_input("Number of reducers:"))
snum = int(raw_input("Number of servers:"))
optimal = 0
opt_ass = list()
total = 0
# Assuming rnum = snum.

matrix = [[0 for x in range(snum)] for y in range(rnum)]

matrix = [[28131342, 28133760, 28143302, 28158980, 28172088, 28185175, 28196149, 28201074, 28201265, 28194914, 28187055, 28172112, 28156456, 28145182, 28133906, 28130155],
[28177832, 28184028, 28183812, 28180532, 28172674, 28162230, 28147828, 28139762, 28132723, 28127678, 28123093, 28128604, 28138235, 28146983, 28156365, 28168411],
[29025126, 29033749, 29040341, 29045061, 29047429, 29048262, 29048529, 29041740, 29035224, 29028274, 29023197, 29018474, 29015792, 29017207, 29014992, 29020688],
[28181759, 28190549, 28201231, 28201880, 28197772, 28191699, 28178358, 28162949, 28148018, 28142640, 28132697, 28130492, 28134426, 28144694, 28154605, 28169141],
[28191259, 28196227, 28199767, 28195919, 28185010, 28175907, 28159947, 28147978, 28137314, 28130947, 28128490, 28134593, 28138906, 28155199, 28164505, 28179782],
[28132724, 28145302, 28156887, 28167856, 28176547, 28184938, 28192461, 28190913, 28187535, 28180360, 28168497, 28155325, 28145428, 28137501, 28132797, 28132089],
[27780020, 27776254, 27779002, 27780639, 27779322, 27782816, 27780085, 27778261, 27779809, 27779673, 27777407, 27778322, 27775974, 27773570, 27776140, 27777596],
[28152805, 28164476, 28179067, 28186413, 28190457, 28193834, 28185473, 28174171, 28165827, 28152845, 28141954, 28130632, 28126963, 28126173, 28129010, 28139570],
[28186906, 28189921, 28186860, 28182393, 28172604, 28160556, 28150946, 28142226, 28133272, 28136439, 28134653, 28142683, 28151716, 28162512, 28171971, 28181997],
[28141520, 28138431, 28149437, 28156318, 28165841, 28178440, 28191444, 28198011, 28202646, 28198858, 28192872, 28182676, 28169470, 28158227, 28147127, 28143792],
[28178404, 28172596, 28169759, 28162307, 28154296, 28147076, 28143325, 28139752, 28135725, 28140136, 28143681, 28149321, 28158290, 28165644, 28171062, 28174876],
[28166222, 28173236, 28182424, 28184168, 28187193, 28183827, 28181053, 28169932, 28167882, 28159002, 28156326, 28150626, 28151985, 28152628, 28155821, 28162365],
[30329347, 30324347, 30322371, 30315102, 30310142, 30310051, 30309645, 30309967, 30312298, 30321115, 30320815, 30326638, 30332600, 30331959, 30333104, 30329649],
[28133398, 28138569, 28145422, 28152301, 28165711, 28178388, 28187415, 28192933, 28197429, 28194400, 28191547, 28179793, 28171783, 28159098, 28146685, 28139963],
[28165073, 28173112, 28178916, 28184141, 28181249, 28174879, 28167569, 28157724, 28145629, 28138350, 28130499, 28126917, 28130956, 28134820, 28144274, 28156482],
[28161857, 28157448, 28155418, 28151045, 28147641, 28145793, 28144425, 28144713, 28144151, 28151005, 28156035, 28158799, 28162847, 28161811, 28162262, 28164925]]
#for x in range(rnum):
#    for y in range(snum):
#        print "Please enter the edge weight for reducer", x, "on server", y, ": "
#        ew = int(raw_input())
#        matrix[x][y] = ew


for x in range(rnum):
    print "\n"
    for y in range(snum):
        print(matrix[x][y]),
print "\n"

#perms = list(itertools.permutations(range(snum)))
#print "Total number of permutations: ", len(perms)
#for perm in perms:
#for server 0  1  2  3  4  5  6  7  8   9  10  11  12  13  14  15
#          16  5 13  4  8  9 15  7  14  6  12  10  3   1   11   2
perm = [15 , 7 , 14 , 10 , 9 , 0 , 3 , 13 , 8 , 1 , 6 , 12 , 4 , 2 , 11 , 5]
assignment = list(perm)
max = 0

for i in range(rnum):
    ass_ri = assignment[i]
    #    sum_ri = sum((matrix[i])) - matrix[i][ass_ri]
    print "Reducer ", i, "onto ", ass_ri, " with cost: ", matrix[i][ass_ri]
    if matrix[i][ass_ri] > max:
        max = matrix[i][ass_ri]
    print "Current MAX!!!: ", max
#    total = 0

print "max with assignment: ", max, "with ", perm














