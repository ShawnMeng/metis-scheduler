#!/usr/bin/python2

import itertools

print "Start process of computing optimal sum(X)"

rnum = int(raw_input("Number of reducers:"))
snum = int(raw_input("Number of servers:"))
optimal = 0
opt_ass = list()
total = 0
# Assuming rnum = snum.

matrix = [[0 for x in range(snum)] for y in range(rnum)]

matrix = [[207245,124263,41386,41491,41386,82877,207245,41386,0,124368,124368,41386,82877,41491,41491,82772],
[193141,115975,38696,38583,38696,77279,193141,38696,0,115862,115862,38696,77279,38583,38583,77392],
[205357,123091,40979,41133,40979,82112,205357,40979,0,123245,123245,40979,82112,41133,41133,81958],
[195630,117546,39252,39042,39252,78294,195630,39252,0,117336,117336,39252,78294,39042,39042,78504],
[203578,122198,40754,40690,40754,81444,203578,40754,0,122134,122134,40754,81444,40690,40690,81508],
[196509,117887,39288,39311,39288,78599,196509,39288,0,117910,117910,39288,78599,39311,39311,78576],
[203550,122030,40635,40760,40635,81395,203550,40635,0,122155,122155,40635,81395,40760,40760,81270],
[192448,115636,38615,38406,38615,77021,192448,38615,0,115427,115427,38615,77021,38406,38406,77230],
[198564,118756,39426,39904,39426,79330,198564,39426,0,119234,119234,39426,79330,39904,39904,78852],
[202327,121397,40466,40465,40466,80931,202327,40466,0,121396,121396,40466,80931,40465,40465,80932],
[204022,122622,40961,40700,40961,81661,204022,40961,0,122361,122361,40961,81661,40700,40700,81922],
[209136,125184,41604,41976,41604,83580,209136,41604,0,125556,125556,41604,83580,41976,41976,83208],
[188855,113353,37801,37751,37801,75552,188855,37801,0,113303,113303,37801,75552,37751,37751,75602],
[203005,121847,40634,40579,40634,81213,203005,40634,0,121792,121792,40634,81213,40579,40579,81268],
[203429,122131,40741,40649,40741,81390,203429,40741,0,122039,122039,40741,81390,40649,40649,81482],
[193204,116084,38762,38560,38762,77322,193204,38762,0,115882,115882,38762,77322,38560,38560,77524]]

#for x in range(rnum):
#    for y in range(snum):
#        print "Please enter the edge weight for reducer", x, "on server", y, ": "
#        ew = int(raw_input())
#        matrix[x][y] = ew


for x in range(rnum):
    print "\n"
    for y in range(snum):
        print(matrix[x][y]),
print "\n"

perms = list(itertools.permutations(range(snum)))
print "Total number of permutations: ", len(perms)
for perm in perms:
    assignment = list(perm)
    for i in range(rnum):
        ass_ri = assignment[i]
        sum_ri = sum((matrix[i])) - matrix[i][ass_ri]
        total += sum_ri
    print perm, total
    if total <= optimal or optimal == 0:
        optimal = total
        opt_ass = assignment
        print "Current BEST!!!: ", optimal, "with ", opt_ass
    total = 0

print "OPTIMAL!!!: ", optimal, "with ", opt_ass















